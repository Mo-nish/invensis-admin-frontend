{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import axios from'axios';// Set the base URL for admin API\nimport{jsx as _jsx}from\"react/jsx-runtime\";axios.defaults.baseURL='https://invensis-admin-api.onrender.com';const AuthContext=/*#__PURE__*/createContext();export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export const AuthProvider=_ref=>{let{children}=_ref;const[admin,setAdmin]=useState(null);const[loading,setLoading]=useState(true);useEffect(()=>{const adminToken=localStorage.getItem('admin_token');if(adminToken){axios.defaults.headers.common['Authorization']=`Bearer ${adminToken}`;checkAdminAuthStatus();}else{setLoading(false);}},[]);const checkAdminAuthStatus=async()=>{try{const response=await axios.get('/api/admin/auth/me');setAdmin(response.data.admin);}catch(error){console.error('Admin auth check failed:',error);localStorage.removeItem('admin_token');delete axios.defaults.headers.common['Authorization'];}finally{setLoading(false);}};const adminLogin=async(email,password)=>{try{const response=await axios.post('/api/admin/auth/login',{email,password});const{token,admin}=response.data;localStorage.setItem('admin_token',token);axios.defaults.headers.common['Authorization']=`Bearer ${token}`;setAdmin(admin);return{success:true};}catch(error){var _error$response,_error$response$data;return{success:false,message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Admin login failed'};}};const adminRegister=async adminData=>{try{const response=await axios.post('/api/admin/auth/register',adminData);const{token,admin}=response.data;localStorage.setItem('admin_token',token);axios.defaults.headers.common['Authorization']=`Bearer ${token}`;setAdmin(admin);return{success:true};}catch(error){var _error$response2,_error$response2$data;return{success:false,message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Admin registration failed'};}};const adminLogout=async()=>{try{await axios.post('/api/admin/auth/logout');}catch(error){console.error('Logout API call failed:',error);}finally{localStorage.removeItem('admin_token');delete axios.defaults.headers.common['Authorization'];setAdmin(null);}};const value={admin,loading,adminLogin,adminRegister,adminLogout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","axios","jsx","_jsx","defaults","baseURL","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","admin","setAdmin","loading","setLoading","adminToken","localStorage","getItem","headers","common","checkAdminAuthStatus","response","get","data","error","console","removeItem","adminLogin","email","password","post","token","setItem","success","_error$response","_error$response$data","message","adminRegister","adminData","_error$response2","_error$response2$data","adminLogout","value","Provider"],"sources":["/Users/monishreddy/Documents/Invensis Recruiteres copy/admin-portal/admin-frontend-deploy/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport axios from 'axios';\n\n// Set the base URL for admin API\naxios.defaults.baseURL = 'https://invensis-admin-api.onrender.com';\n\nconst AuthContext = createContext();\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n\nexport const AuthProvider = ({ children }) => {\n  const [admin, setAdmin] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    const adminToken = localStorage.getItem('admin_token');\n    if (adminToken) {\n      axios.defaults.headers.common['Authorization'] = `Bearer ${adminToken}`;\n      checkAdminAuthStatus();\n    } else {\n      setLoading(false);\n    }\n  }, []);\n\n  const checkAdminAuthStatus = async () => {\n    try {\n      const response = await axios.get('/api/admin/auth/me');\n      setAdmin(response.data.admin);\n    } catch (error) {\n      console.error('Admin auth check failed:', error);\n      localStorage.removeItem('admin_token');\n      delete axios.defaults.headers.common['Authorization'];\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const adminLogin = async (email, password) => {\n    try {\n      const response = await axios.post('/api/admin/auth/login', { email, password });\n      const { token, admin } = response.data;\n      \n      localStorage.setItem('admin_token', token);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setAdmin(admin);\n      \n      return { success: true };\n    } catch (error) {\n      return { \n        success: false, \n        message: error.response?.data?.message || 'Admin login failed' \n      };\n    }\n  };\n\n  const adminRegister = async (adminData) => {\n    try {\n      const response = await axios.post('/api/admin/auth/register', adminData);\n      const { token, admin } = response.data;\n      \n      localStorage.setItem('admin_token', token);\n      axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      setAdmin(admin);\n      \n      return { success: true };\n    } catch (error) {\n      return { \n        success: false, \n        message: error.response?.data?.message || 'Admin registration failed' \n      };\n    }\n  };\n\n  const adminLogout = async () => {\n    try {\n      await axios.post('/api/admin/auth/logout');\n    } catch (error) {\n      console.error('Logout API call failed:', error);\n    } finally {\n      localStorage.removeItem('admin_token');\n      delete axios.defaults.headers.common['Authorization'];\n      setAdmin(null);\n    }\n  };\n\n  const value = {\n    admin,\n    loading,\n    adminLogin,\n    adminRegister,\n    adminLogout\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}